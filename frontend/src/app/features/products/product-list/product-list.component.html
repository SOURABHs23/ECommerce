<div class="products-container">
    <div class="products-header">
        <h1>Discover Products</h1>
        <p>Find the perfect items for you</p>
    </div>

    <div class="products-layout">
        <!-- Sidebar Filters -->
        <aside class="filters-sidebar">
            <mat-card class="filter-card">
                <mat-card-header>
                    <mat-card-title>Filters</mat-card-title>
                </mat-card-header>
                <mat-card-content class="filter-content">

                    <!-- Search -->
                    <div class="filter-section">
                        <h3>Search</h3>
                        <mat-form-field appearance="outline" class="full-width">
                            <mat-label>Search products</mat-label>
                            <input matInput type="text" [(ngModel)]="searchQuery" (keyup.enter)="searchProducts()">
                            <mat-icon matSuffix (click)="searchProducts()" style="cursor: pointer">search</mat-icon>
                        </mat-form-field>
                    </div>

                    <mat-divider></mat-divider>

                    <!-- Categories -->
                    <div class="filter-section">
                        <h3>Categories</h3>
                        <mat-chip-listbox class="category-chips" aria-label="Category selection">
                            <mat-chip-option [selected]="!selectedCategory" (click)="selectCategory(null)">
                                All Products
                            </mat-chip-option>
                            @for (category of categories(); track category.id) {
                            <mat-chip-option [selected]="selectedCategory === category.id"
                                (click)="selectCategory(category.id)">
                                {{ category.name }}
                            </mat-chip-option>
                            }
                        </mat-chip-listbox>
                    </div>

                    <mat-divider></mat-divider>

                    <!-- Price Range -->
                    <div class="filter-section">
                        <h3>Price Range</h3>
                        <div class="price-inputs">
                            <mat-form-field appearance="outline" class="price-field">
                                <mat-label>Min</mat-label>
                                <span matTextPrefix>â‚¹&nbsp;</span>
                                <input matInput type="number" [(ngModel)]="minPrice">
                            </mat-form-field>
                            <span class="range-separator">-</span>
                            <mat-form-field appearance="outline" class="price-field">
                                <mat-label>Max</mat-label>
                                <span matTextPrefix>â‚¹&nbsp;</span>
                                <input matInput type="number" [(ngModel)]="maxPrice">
                            </mat-form-field>
                        </div>
                        <button mat-raised-button color="primary" class="full-width" (click)="applyFilters()">
                            Apply Filters
                        </button>
                    </div>
                </mat-card-content>
            </mat-card>
        </aside>

        <!-- Products Grid -->
        <main class="products-main">
            @if (loading()) {
            <div class="loading-state">
                <div class="spinner"></div>
                <p>Loading products...</p>
            </div>
            } @else if (products().length === 0) {
            <div class="empty-state">
                <span class="empty-icon">ðŸ“¦</span>
                <h2>No products found</h2>
                <p>Try adjusting your filters or search query</p>
            </div>
            } @else {
            <div class="products-grid">
                @for (product of products(); track product.id) {
                <app-product-card [product]="product" (addToCart)="onAddToCart($event)" />
                }
            </div>

            @if (pageResponse() && !pageResponse()!.last) {
            <div class="load-more">
                <button class="load-more-btn" (click)="loadMore()" [disabled]="loading()">
                    Load More
                </button>
            </div>
            }
            }
        </main>
    </div>
</div>