<div class="orders-container">
    <div class="orders-header">
        <h1>My Orders</h1>
        <p class="subtitle">Track and manage your orders</p>
    </div>

    @if (loading()) {
    <div class="loading-container">
        <mat-spinner diameter="50"></mat-spinner>
        <p>Loading orders...</p>
    </div>
    } @else if (orders().length === 0) {
    <mat-card class="empty-orders">
        <mat-card-content>
            <div class="empty-content">
                <span class="empty-icon">ðŸ“¦</span>
                <h2>No Orders Yet</h2>
                <p>Start shopping to see your orders here!</p>
                <a routerLink="/products" mat-raised-button color="primary">
                    Browse Products
                </a>
            </div>
        </mat-card-content>
    </mat-card>
    } @else {
    <div class="orders-list">
        @for (order of orders(); track order.id) {
        <mat-card class="order-card">
            <mat-card-header>
                <div class="order-header-content">
                    <div class="order-info">
                        <span class="order-number">{{ order.orderNumber }}</span>
                        <span class="order-date">{{ order.createdAt | date:'medium' }}</span>
                    </div>
                    <mat-chip [color]="getStatusColor(order.status)" highlighted>
                        {{ order.status }}
                    </mat-chip>
                </div>
            </mat-card-header>

            <mat-divider></mat-divider>

            <mat-card-content>
                <div class="order-items">
                    @for (item of order.items; track item.id) {
                    <div class="order-item">
                        <div class="item-image">
                            @if (item.productImage) {
                            <img [src]="item.productImage" [alt]="item.productName">
                            } @else {
                            <div class="no-image">ðŸ“¦</div>
                            }
                        </div>
                        <div class="item-details">
                            <span class="item-name">{{ item.productName }}</span>
                            <span class="item-qty">Qty: {{ item.quantity }}</span>
                        </div>
                        <div class="item-price">
                            {{ item.subtotal | currency }}
                        </div>
                    </div>
                    }
                </div>

                <mat-divider></mat-divider>

                <div class="order-summary">
                    <div class="summary-row">
                        <span>Subtotal</span>
                        <span>{{ order.subtotal | currency }}</span>
                    </div>
                    <div class="summary-row">
                        <span>Shipping</span>
                        <span>{{ order.shippingCost | currency }}</span>
                    </div>
                    <div class="summary-row">
                        <span>Tax</span>
                        <span>{{ order.tax | currency }}</span>
                    </div>
                    <div class="summary-row total">
                        <span>Total</span>
                        <span>{{ order.totalAmount | currency }}</span>
                    </div>
                </div>

                <div class="shipping-address">
                    <h4>Shipping Address</h4>
                    <p>
                        {{ order.shippingAddress.fullName }}<br>
                        {{ order.shippingAddress.addressLine1 }}<br>
                        @if (order.shippingAddress.addressLine2) {
                        {{ order.shippingAddress.addressLine2 }}<br>
                        }
                        {{ order.shippingAddress.city }}, {{ order.shippingAddress.state }}
                        {{ order.shippingAddress.postalCode }}<br>
                        {{ order.shippingAddress.country }}
                    </p>
                </div>
            </mat-card-content>

            <mat-card-actions align="end">
                @if (canCancel(order.status)) {
                <button mat-button color="warn" (click)="cancelOrder(order.id)">
                    <mat-icon>cancel</mat-icon>
                    Cancel Order
                </button>
                }
            </mat-card-actions>
        </mat-card>
        }
    </div>

    @if (hasMore()) {
    <div class="load-more">
        <button mat-stroked-button color="primary" (click)="loadMore()">
            Load More Orders
        </button>
    </div>
    }
    }
</div>
